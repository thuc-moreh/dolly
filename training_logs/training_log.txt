[2023-05-25 14:51:11.972] [info] Requesting resources for KT AI Accelerator from the server...
[2023-05-25 14:51:12.988] [warning] A newer version of Moreh AI Framework is available. You can update the software to the latest version by running "update-moreh".
[2023-05-25 14:51:12.988] [info] Initializing the worker daemon for KT AI Accelerator
[2023-05-25 14:51:16.692] [info] [1/1] Connecting to resources on the server (192.168.110.18:24171)...
[2023-05-25 14:51:16.705] [info] Establishing links to the resources...
[2023-05-25 14:51:16.850] [info] KT AI Accelerator is ready to use.

python training/trainer.py
[2023-05-26 11:40:06.359] [info] Requesting resources for KT AI Accelerator from the server...
[2023-05-26 11:40:07.380] [info] Initializing the worker daemon for KT AI Accelerator
[2023-05-26 11:40:11.652] [info] [1/2] Connecting to resources on the server (192.168.110.22:24168)...
[2023-05-26 11:40:11.667] [info] [2/2] Connecting to resources on the server (192.168.110.25:24161)...
[2023-05-26 11:40:11.675] [info] Establishing links to the resources...
[2023-05-26 11:40:11.801] [info] KT AI Accelerator is ready to use.
2023-05-26 11:40:11 INFO [__main__] Loading tokenizer for databricks/dolly-v2-3b
2023-05-26 11:40:12 INFO [__main__] Loading model for databricks/dolly-v2-3b
2023-05-26 11:40:47 INFO [__main__] Found max lenth: 2048
2023-05-26 11:40:47 INFO [__main__] Loading dataset from databricks/databricks-dolly-15k
2023-05-26 11:40:49 WARNING [datasets.builder] Found cached dataset json (/nas/common_data/huggingface/databricks___json/databricks--databricks-dolly-15k-6e0f9ea7eaa0ee08/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
2023-05-26 11:40:49 INFO [__main__] Found 150 rows
2023-05-26 11:40:49 WARNING [datasets.arrow_dataset] Loading cached processed dataset at /nas/common_data/huggingface/databricks___json/databricks--databricks-dolly-15k-6e0f9ea7eaa0ee08/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-951ee09a1cec13a5.arrow
2023-05-26 11:40:49 INFO [__main__] Preprocessing dataset
2023-05-26 11:40:49 WARNING [datasets.arrow_dataset] Loading cached processed dataset at /nas/common_data/huggingface/databricks___json/databricks--databricks-dolly-15k-6e0f9ea7eaa0ee08/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-811a0824a36fdb48.arrow
2023-05-26 11:40:49 INFO [__main__] Processed dataset has 150 rows
2023-05-26 11:40:49 WARNING [datasets.arrow_dataset] Loading cached processed dataset at /nas/common_data/huggingface/databricks___json/databricks--databricks-dolly-15k-6e0f9ea7eaa0ee08/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-748920448fa0c772.arrow
2023-05-26 11:40:49 INFO [__main__] Processed dataset has 150 rows after filtering for truncated records
2023-05-26 11:40:49 INFO [__main__] Shuffling dataset
2023-05-26 11:40:49 WARNING [datasets.arrow_dataset] Loading cached shuffled indices for dataset at /nas/common_data/huggingface/databricks___json/databricks--databricks-dolly-15k-6e0f9ea7eaa0ee08/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-ba7f38e32ba70245.arrow
2023-05-26 11:40:49 INFO [__main__] Done preprocessing
2023-05-26 11:40:49 WARNING [datasets.arrow_dataset] Loading cached split indices for dataset at /nas/common_data/huggingface/databricks___json/databricks--databricks-dolly-15k-6e0f9ea7eaa0ee08/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-8c057e78c23e6e41.arrow and /nas/common_data/huggingface/databricks___json/databricks--databricks-dolly-15k-6e0f9ea7eaa0ee08/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-317a904bba5ccb85.arrow
2023-05-26 11:40:49 INFO [__main__] Train data size: 140
2023-05-26 11:40:49 INFO [__main__] Test data size: 10
2023-05-26 11:40:49 WARNING [__main__] Will NOT save to DBFS
2023-05-26 11:40:49 INFO [__main__] Instantiating Trainer
2023-05-26 11:40:54 INFO [__main__] Training
You're using a GPTNeoXTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
{'loss': 1.0962, 'learning_rate': 9.285714285714288e-06, 'epoch': 0.07}
{'loss': 1.3366, 'learning_rate': 8.571428571428571e-06, 'epoch': 0.14}
{'loss': 1.0792, 'learning_rate': 7.857142857142858e-06, 'epoch': 0.21}
{'loss': 0.8323, 'learning_rate': 7.1428571428571436e-06, 'epoch': 0.29}
[2023-05-26 11:43:47.917] [error] KT AI Accelerator (#0) received an invalid request from the application.
Error message: device1 error occurred : "KT AI Accelerator memory not enough. Try increasing KT AI Accelerator size or decreasing batch size."
[1685069028.234527] [moreh-2004-vm08:709024:0]         tcp_ep.c:1042 UCX  ERROR tcp_ep 0x7fcfa80431d0 (state=CONNECTED): recv(48) failed: Connection reset by remote peer
/arrow/cpp/src/arrow/filesystem/s3fs.cc:2598:  arrow::fs::FinalizeS3 was not called even though S3 was initialized.  This could lead to a segmentation fault at exit